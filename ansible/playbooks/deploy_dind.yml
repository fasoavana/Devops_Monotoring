---
- name: Deploiement Blog sur Docker-in-Docker (Alpine)
  hosts: web
  gather_facts: no
  vars:
    ansible_become: no  # On d√©sactive explicitement sudo
  tasks:
    - name: Installer Python3 pour Ansible
      raw: apk add --no-cache python3
      # Pas de become: yes ici

    - name: Creer le dossier de l'application
      file:
        path: /opt/blog-app
        state: directory

    - name: Lancer le Backend (faso01)
      shell: "docker run -d -p 5000:5000 --name backend-api faso01/blog-backend:latest"

    - name: Lancer le Frontend (faso01)
      shell: "docker run -d -p 80:80 --name frontend-web faso01/blog-frontend:latest"
